标签：[[数学]] [[多元函数微分]] [[公式]]

# 无条件极值

## 必要条件

根据[[Fermat定理]]， 任何一个一元函数取极值的必要条件都是$f'(x_0) = 0$。那么对于多元函数， 我们也有类似的定理。即必要条件:

极值点处所有一阶偏导数必须存在且可微，并且满足
$$
f'_{x_i}(\mathbf{x_0}) = 0
$$

满足该条件的点称为驻点。但是需要注意的是，驻点$\neq$极值点。但是（偏导数存在的）极值点$\in$驻点。因为还会有一些诡异的点存在。如对于$z=xy$在$(0,0)$处的情况。称为鞍点，既非极大值，也非极小值。

实际上即为[[梯度]]=0, 真tm神奇. 

## 极值点充分条件

接下来使用[[多元函数Taylor公式#Hessian矩阵]]我们可以给出极值点的充分条件。

对于n元函数，我们可以给出其Hessian矩阵。在该矩阵满秩的前提下：
1. 如果正定（从左上角逐渐增大, $1\times1\to2\times2\to\dots n\times n$的矩阵行列式均为正），则该点为极小值
2. 如果负定（与上面定义类似，但是行列式为负正负正交替），则该点为极大值点
3. 若既不正定也不负定（包括行列式出现0或者不符合其上规律），那么该点即不为极大值也不为极小值。

## 最值

判断极值点和端点即可. 

# 应用: [[最小二乘法]]

# 条件最值

很多时候, 往往不是无条件的, 在求函数最值的时候, 会附带上对于自变量的函数限制. 这种情况就演变为了条件极值, 我们需要引入新的方法: Lagrange乘数法. 

这一类问题通常可以归结为以下形式: 
$$
\begin{cases}
\min F(x_{1}, \dots,x_{n})\  或\ \max G(x_{1}, \dots, x_{n}) \\
f_{1}(x_{1}, \dots , x_{n}) = 0 \\
\dots \\
f_{m}(x_{1}, \dots x_{n}) = 0
\end{cases}
$$
对于这类问题, 我们可以一步步拆解. 

对于任意一个约束条件, 我们实际上都可以看做实际上减少方程的一个自由度. 因此m个约束条件实际上就减少了m个自由度. 那么我们实际上可以使用每一个特殊的$f_{k}$做到减少一个自由度的效果. 

证明思路如下: 

通过任意的$f_{k} = 0$的条件, 我们实际上能够得出关于$x_{n-k+1}$的一个函数表达式: 
$$
\phi_{k}(x_{1}, \dots , x_{n-k},x_{n-k+2},  \dots, x_{n}) = x_{n-k+1}
$$

原来的min F就可以化简啦, 可以把这些统统化简掉, 变为这样求一个表达式的极值: 
$$
u = F(x_{1}, \dots, x_{n-m}, \phi_{m}(x_{1}, \dots x_{n-m}), \dots, \phi_{1}(x_{1}, \dots, x_{n-m}))
$$

根据隐函数求导法则, 可以得到: 
$$
\frac{ \partial u }{ \partial x_{p} } = \frac{ \partial F }{ \partial x_{p} } + \frac{ \partial F }{ \partial x_{n} } \cdot \frac{ \partial \phi_{q} }{ \partial x_{p} } /\frac{ \partial \phi_{q} }{ \partial x_{n} }  
$$

由上面无条件极值的条件得: 
$$
\frac{ \partial u }{ \partial x_{p} } = 0
$$
我们令$\lambda_{q} = \frac{ \partial F }{ \partial x_{n} }/ \frac{ \partial \phi_{q} }{ \partial x_{n} }$

则存在如下式子: 
$$
\begin{cases}
\frac{ \partial F }{ \partial x_{p} } + \lambda_{q} \frac{ \partial \phi_{q} }{ \partial x_{p} } = 0  & p = 1,2,\dots n\\
f_{1}(x_{1}, \dots , x_{n}) = 0 \\
\dots \\
f_{m}(x_{1}, \dots , x_{n}) = 0
\end{cases}
$$

ok经过了痛苦不堪的证明过程, 接下来就是简单的解题部分: 

我们只需要根据约束条件的数量设$\lambda$, 然后愉快的求偏导即可捏. 之后再使用极值点充分条件去验证该点是否确为极值点. 